(()=>{const e=e=>Array.from(e.querySelectorAll("li.research-item")),t=e=>String(e??"").toLowerCase().trim(),r=(e,t)=>{if(!t||"all"===t)return!0;const r=e.getAttribute("data-stage")||"",a="true"===e.getAttribute("data-preprint");return"preprint"===t?a:r===t},a=(e,r)=>{if(!r)return!0;const a=e.getAttribute("data-title")||"",l=e.getAttribute("data-venue")||"";return t(`${a} ${l} ${e.textContent||""}`).includes(r)},l=e=>{e.querySelectorAll("details").forEach(e=>{const t=Array.from(e.querySelectorAll("li.research-item"));if(0===t.length)return;const r=t.some(e=>"none"!==e.style.display);e.style.display=r?"":"none"}),e.querySelectorAll("ul").forEach(e=>{const t=Array.from(e.querySelectorAll(":scope > li.research-item"));if(0===t.length)return;const r=t.some(e=>"none"!==e.style.display);e.style.display=r?"":"none"})},n=n=>{const o=n.querySelector("[data-research-filter-input]"),s=n.querySelector("[data-research-filter-count]"),c=Array.from(n.querySelectorAll("[data-research-filter-stage]"));if(!o||0===c.length)return;const i=document.querySelector("[data-research-portfolio]");if(!i)return;const u=e(i),d={stage:"all",query:""},y=()=>{const e=t(d.query);let n=0;u.forEach(t=>{const l=r(t,d.stage)&&a(t,e);t.style.display=l?"":"none",l&&(n+=1)}),l(i),s&&(s.textContent=`${n} / ${u.length}`)},f=()=>{c.forEach(e=>{const t=e.getAttribute("data-research-filter-stage")||"all";e.classList.toggle("is-active",t===d.stage)})};o.addEventListener("input",()=>{d.query=o.value||"",y()}),c.forEach(e=>{e.addEventListener("click",()=>{d.stage=e.getAttribute("data-research-filter-stage")||"all",f(),y()})}),f(),y()},o=()=>{document.querySelectorAll("[data-research-filter]").forEach(n)};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",o,{once:!0}):o()})();