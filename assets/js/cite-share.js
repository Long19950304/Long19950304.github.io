(()=>{const t=async t=>{const e=String(t??"");try{return await navigator.clipboard.writeText(e),!0}catch{try{const t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="fixed",t.style.top="-1000px",t.style.left="-1000px",document.body.appendChild(t),t.select();const n=document.execCommand("copy");return document.body.removeChild(t),n}catch{return!1}}},e=(t,e,n)=>{const o=new Blob([String(e??"")],{type:n||"text/plain;charset=utf-8"}),i=URL.createObjectURL(o),r=document.createElement("a");r.href=i,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(i)},n=t=>String(t??"").replace(/\r\n/g,"\n").trim()+"\n",o=t=>String(t??"").replace(/\r\n/g,"\n").trim()+"\n",i=t=>{const e=t.querySelector("script.cite-share__data");if(!e)return null;try{return JSON.parse(e.textContent||"{}")}catch{return null}},r=(t,e)=>{const n=t.querySelector("summary.cite-share__summary");if(!n)return;const o=n.textContent;n.textContent=e,window.setTimeout(()=>{n.textContent=o},1100)},a=a=>{const c=i(a);c&&a.addEventListener("click",async i=>{const d=i.target;if(!(d instanceof HTMLElement))return;const l=d.getAttribute("data-cite-share-action");if(!l)return;i.preventDefault(),i.stopPropagation();const s=c.key||"citation",u=c.canonical_url||c.url||"",p=c.citation_plain||"",y=n(c.bibtex||""),m=o(c.ris||"");if("copy_link"===l){const e=await t(u);return void r(a,e?"Link copied":"Copy failed")}if("copy_citation"===l){const e=await t(p);return void r(a,e?"Citation copied":"Copy failed")}if("copy_bibtex"===l){const e=await t(y);return void r(a,e?"BibTeX copied":"Copy failed")}if("copy_ris"===l){const e=await t(m);return void r(a,e?"RIS copied":"Copy failed")}return"download_bibtex"===l?(e(`${s}.bib`,y,"application/x-bibtex;charset=utf-8"),void r(a,"Downloading\u2026")):"download_ris"===l?(e(`${s}.ris`,m,"application/x-research-info-systems;charset=utf-8"),void r(a,"Downloading\u2026")):void 0})},c=()=>{document.querySelectorAll("details.cite-share").forEach(a)};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",c,{once:!0}):c()})();